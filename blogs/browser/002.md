---
title: 001 从输入URL到页面展示，这中间发生了什么？
date: 2021-04-19
categories: 
 - 浏览器工作原理
tags:
 - 浏览器工作原理
sidebar: 'auto'
---

“在浏览器中，从输入URL到页面展示，这中间发生了什么？”这是一道经典的面试题，这道题设计网络、操作系统、Web等一系列的知识，可以综合考察面试者的知识掌握程度。

这里，先介绍一个概念：**用户发出请求URL请求到页面开始解析的这个过程，就叫做导航**。

这个问题可以分为以下阶段：

1. 用户输入

当用户在地址栏输入关键字时，地址栏会判断输入的关键字是搜索内容，还是请求的URL。

- 如果是搜索内容，地址栏则会使用浏览器的默认搜索引擎，来合成新的带搜索关键字的URL。
- 如果判断内容符合URL规则，那么地址栏会根据规则，把这段内容加上协议，合成完整的URL。

当用户输入关键字并按下回车之后，这意味着当前页面即将被新的页面所替换，但在这之前，浏览器会触发beforeunload事件，beforeunload事件主要有两个作用，一是可以在退出当前页面前做一些清理工作，二是可以询问用户是否确认离开当前页面，比如当前页面可能还有未提交完成的表单等情况，因此用户可以通过beforeunload事件来取消导航，让浏览器不再执行任何后续工作。

如果当前页面没有监听beforeunload事件或者同意了继续后续流程，那么浏览器则会进入加载状态。此时浏览器标签页的loading图标闪动，但页面显示的仍然是之前打开的页面内容，并没有立即被新页面替换，要等到提交文档阶段，页面内容才会被替换。

2. URL请求过程